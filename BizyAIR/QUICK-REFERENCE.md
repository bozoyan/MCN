# BizyAIR Studio - å¿«é€Ÿå‚è€ƒæŒ‡å—

## ğŸš€ å¿«é€Ÿå¯åŠ¨

```bash
# å¯åŠ¨æœåŠ¡å™¨
./start.sh

# æˆ–æ‰‹åŠ¨å¯åŠ¨
php -S 127.0.0.1:8004 index.php

# è®¿é—®åº”ç”¨
open http://127.0.0.1:8004
```

---

## ğŸ“ æ–‡ä»¶ç»“æ„é€ŸæŸ¥

```
index.php (1846è¡Œ)
â”œâ”€â”€ 1-120:     PHP åç«¯
â”‚   â”œâ”€â”€ 8-26:      è·¯ç”±å¤„ç†
â”‚   â””â”€â”€ 36-119:    API ç«¯ç‚¹
â”‚
â”œâ”€â”€ 121-483:  HTML + CSS
â”‚   â”œâ”€â”€ 121-122:   HTML å¤´éƒ¨
â”‚   â”œâ”€â”€ 123-454:   CSS æ ·å¼
â”‚   â””â”€â”€ 456-760:   HTML ç»“æ„
â”‚
â””â”€â”€ 761-1846: JavaScript
    â”œâ”€â”€ 688-738:   å…¨å±€é…ç½®
    â”œâ”€â”€ 761-1042:  æ ¸å¿ƒåŠŸèƒ½
    â”œâ”€â”€ 1043-1341:  UI äº¤äº’
    â””â”€â”€ 1342-1846:  API é›†æˆ
```

---

## ğŸ”‘ å…³é”®é…ç½®

### å…¨å±€å˜é‡ (688-738è¡Œ)
```javascript
let currentMode = 'canvas';        // å½“å‰æ¨¡å¼
let apiKey = '...';                 // BizyAir API å¯†é’¥
let currentWebAppId = 39419;        // åº”ç”¨ ID
const API_TIMEOUT = 1200000;        // 20åˆ†é’Ÿè¶…æ—¶
```

### CSS å˜é‡ (103-114è¡Œ)
```css
--bg-color: #1e1e1e
--accent: #4dabf7
--font-mono: 'SF Mono', 'Roboto Mono', monospace
```

---

## ğŸŒ API ç«¯ç‚¹é€ŸæŸ¥

### æœ¬åœ° API (PHP)

| ç«¯ç‚¹ | æ–¹æ³• | åŠŸèƒ½ | è¡Œå· |
|------|------|------|------|
| `/api/configs` | GET | è·å–é…ç½®åˆ—è¡¨ | 54-65 |
| `/api/config/{name}` | GET | è¯»å–é…ç½® | 80-88 |
| `/api/config/{name}` | POST | ä¿å­˜é…ç½® | 90-107 |
| `/api/config/{name}` | DELETE | åˆ é™¤é…ç½® | 108-117 |

### BizyAir API (å¤–éƒ¨)

| ç«¯ç‚¹ | ç”¨é€” | è¶…æ—¶ | è¡Œå· |
|------|------|------|------|
| `/w/v1/webapp/task/openapi/create` | åˆ›å»ºä»»åŠ¡ | 20åˆ†é’Ÿ | 1183 |
| `/w/v1/webapp/task/{id}/status` | æ£€æŸ¥çŠ¶æ€ | 20åˆ†é’Ÿ | 1765 |

---

## ğŸ¨ è§†å›¾æ¨¡å¼

### 1. ç”»å¸ƒæ¨¡å¼ (view-canvas)
**è¡Œå·:** 521-573

**åŠŸèƒ½:**
- æ‰‹ç»˜æ¶‚é¸¦
- å›¾ç‰‡ç²˜è´´
- ç¼©æ”¾/æ‹–æ‹½
- æ’¤é”€æ“ä½œ

**å…³é”®å‡½æ•°:**
```javascript
initCanvas()           // 830è¡Œ
updateCanvasRatio()    // 850è¡Œ
undoCanvas()           // 928è¡Œ
clearCanvas()          // 934è¡Œ
```

### 2. èŠ‚ç‚¹æ¨¡å¼ (view-node)
**è¡Œå·:** 574-581

**åŠŸèƒ½:**
- å¯è§†åŒ–å·¥ä½œæµ
- èŠ‚ç‚¹ç¼–è¾‘
- è¿çº¿ç®¡ç†

**å…³é”®å‡½æ•°:**
```javascript
createDefaultNodes()   // 955è¡Œ
parseAndBuildNodes()   // 1023è¡Œ
renderNodes()          // 1043è¡Œ
```

### 3. å†å²æ¨¡å¼ (view-history)
**è¡Œå·:** 582-587

**åŠŸèƒ½:**
- ç”Ÿæˆå†å²
- å›¾ç‰‡é¢„è§ˆ
- æ‰¹é‡åˆ é™¤

**å…³é”®å‡½æ•°:**
```javascript
saveToHistory()        // 1297è¡Œ
loadHistory()          // 1313è¡Œ
deleteHistoryItem()    // 1305è¡Œ
```

### 4. é…ç½®æ¨¡å¼ (view-config)
**è¡Œå·:** 588-615

**åŠŸèƒ½:**
- JSON ç¼–è¾‘
- æ–‡ä»¶ç®¡ç†
- CodeMirror é›†æˆ

**å…³é”®å‡½æ•°:**
```javascript
loadConfigFileList()   // 1536è¡Œ
loadConfigFile()       // 1589è¡Œ
saveCurrentConfig()    // 1613è¡Œ
```

---

## ğŸ”§ å¸¸ç”¨å‡½æ•°

### API è°ƒç”¨
```javascript
// å¸¦è¶…æ—¶çš„ fetch
fetchWithTimeout(url, options, timeout)  // 716è¡Œ

// åˆ›å»ºä»»åŠ¡
startGeneration()                         // 1146è¡Œ

// æ£€æŸ¥çŠ¶æ€
checkTaskStatus(requestId)                // 1757è¡Œ
```

### æ•°æ®ç®¡ç†
```javascript
// ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨
saveToHistory(url)                        // 1297è¡Œ

// åŠ è½½å†å²è®°å½•
loadHistory()                             // 1313è¡Œ

// èŠ‚ç‚¹è½¬ JSON
generateJSONFromNodes()                   // 983è¡Œ
```

### UI æ“ä½œ
```javascript
// åˆ‡æ¢æ¨¡å¼
switchMode(mode)                          // 761è¡Œ

// åˆ‡æ¢ä¾§è¾¹æ 
toggleRightSidebar(forceOpen)             // 782è¡Œ

// æ˜¾ç¤ºå¼¹çª—
openApiModal()                            // 1342è¡Œ
showLightbox(src)                         // 1353è¡Œ
```

---

## ğŸ› è°ƒè¯•æŠ€å·§

### 1. å¯ç”¨è¯¦ç»†æ—¥å¿—
```javascript
// åœ¨ Console ä¸­æŸ¥çœ‹
console.log('Debug:', variable);

// å·²æœ‰çš„æ—¥å¿—ç‚¹
console.log('Sending payload:', ...)     // 1177è¡Œ
console.log('API Response:', ...)         // 1517è¡Œ
console.log('Task Status:', ...)          // 1747è¡Œ
```

### 2. æ£€æŸ¥ç½‘ç»œè¯·æ±‚
```bash
# æŸ¥çœ‹æœåŠ¡å™¨æ—¥å¿—
tail -f /tmp/php-server.log

# æµ‹è¯• API
curl http://127.0.0.1:8004/api/configs
```

### 3. å¸¸è§é”™è¯¯ç 
| é”™è¯¯ | åŸå›  | è§£å†³æ–¹æ¡ˆ |
|------|------|----------|
| 404 | æ–‡ä»¶ä¸å­˜åœ¨ | æ£€æŸ¥ json/ ç›®å½• |
| 500 | JSON æ ¼å¼é”™è¯¯ | éªŒè¯ JSON è¯­æ³• |
| Timeout | è¯·æ±‚è¶…æ—¶ | å¢åŠ  API_TIMEOUT |
| CORS | è·¨åŸŸé—®é¢˜ | æ£€æŸ¥ API ç«¯å£ |

---

## âš™ï¸ é…ç½®æ–‡ä»¶ç¤ºä¾‹

### Wan2.2 é…ç½®ç»“æ„
```json
{
  "web_app_id": 41863,
  "suppress_preview_output": true,
  "input_values": {
    "106:LoadImage.image": "å›¾ç‰‡URLæˆ–Base64",
    "6:CLIPTextEncode.text": "æç¤ºè¯",
    "107:WanImageToVideo.width": 720,
    "107:WanImageToVideo.height": 1280,
    "107:WanImageToVideo.length": 81
  }
}
```

### èŠ‚ç‚¹é…ç½®æ ¼å¼
```json
{
  "web_app_id": 39419,
  "input_values": {
    "èŠ‚ç‚¹ID:èŠ‚ç‚¹åç§°.å‚æ•°å": "å‚æ•°å€¼"
  }
}
```

---

## ğŸ“Š localStorage ç»“æ„

```javascript
// API å¯†é’¥
localStorage.getItem('id_works_api_key')

// å†å²è®°å½•
JSON.parse(localStorage.getItem('id_works_history'))
// [
//   {
//     url: "https://...",
//     time: "10:30:45",
//     id: 1734567890
//   }
// ]
```

---

## ğŸ¯ ä½¿ç”¨åœºæ™¯

### åœºæ™¯ 1: æ‰‹ç»˜ç”Ÿæˆè§†é¢‘
1. æ‰“å¼€ç”»å¸ƒæ¨¡å¼
2. æ‰‹ç»˜è‰å›¾æˆ–ç²˜è´´å›¾ç‰‡
3. è¾“å…¥æç¤ºè¯
4. ç‚¹å‡» GENERATE
5. ç­‰å¾…ç»“æœï¼ˆæœ€å¤š20åˆ†é’Ÿï¼‰

### åœºæ™¯ 2: é…ç½®å·¥ä½œæµ
1. æ‰“å¼€é…ç½®ç®¡ç†å™¨
2. é€‰æ‹©æˆ–åˆ›å»ºé…ç½®
3. ç¼–è¾‘å‚æ•°
4. ç‚¹å‡»"å¯¼å…¥èŠ‚ç‚¹"
5. åœ¨èŠ‚ç‚¹æ¨¡å¼ä¸­è¿è¡Œ

### åœºæ™¯ 3: æ‰¹é‡å¤„ç†
1. å‡†å¤‡å¤šä¸ªé…ç½®æ–‡ä»¶
2. ä¿å­˜åˆ° json/ ç›®å½•
3. åœ¨é…ç½®ç®¡ç†å™¨ä¸­åˆ‡æ¢
4. ä¾æ¬¡å¯¼å…¥å’Œæ‰§è¡Œ

---

## ğŸ” å®‰å…¨æ£€æŸ¥æ¸…å•

- [ ] API å¯†é’¥ä¸æš´éœ²åœ¨ä»£ç ä¸­
- [ ] ç”Ÿäº§ç¯å¢ƒä½¿ç”¨ HTTPS
- [ ] CORS é™åˆ¶å…è®¸çš„åŸŸå
- [ ] æ–‡ä»¶ä¸Šä¼ å¤§å°é™åˆ¶
- [ ] JSON éªŒè¯å’Œæ¸…æ´—
- [ ] é”™è¯¯æ¶ˆæ¯ä¸æ³„éœ²æ•æ„Ÿä¿¡æ¯

---

## ğŸ“ˆ æ€§èƒ½æŒ‡æ ‡

| æŒ‡æ ‡ | ç›®æ ‡ | å®é™… |
|------|------|------|
| é¦–æ¬¡åŠ è½½ | < 2ç§’ | ~1.5ç§’ |
| API å“åº” | < 20åˆ†é’Ÿ | 5-15åˆ†é’Ÿ |
| å†å²åŠ è½½ | < 1ç§’ | ~0.5ç§’ |
| èŠ‚ç‚¹æ¸²æŸ“ | < 500ms | ~300ms |

---

## ğŸ› ï¸ ç»´æŠ¤ä»»åŠ¡

### æ—¥å¸¸
- æ¸…ç†æ—§çš„å†å²è®°å½•
- æ£€æŸ¥æ—¥å¿—æ–‡ä»¶å¤§å°
- éªŒè¯å¤‡ä»½é…ç½®

### æ¯å‘¨
- æ¸…ç† localStorage
- æ£€æŸ¥ API å¯†é’¥æœ‰æ•ˆæœŸ
- ä¼˜åŒ–é…ç½®æ–‡ä»¶

### æ¯æœˆ
- æ›´æ–°ä¾èµ–ç‰ˆæœ¬
- æ€§èƒ½æµ‹è¯•
- å®‰å…¨å®¡æŸ¥

---

## ğŸ“ å¿«é€Ÿå¸®åŠ©

| é—®é¢˜ | æŸ¥çœ‹ |
|------|------|
| å¦‚ä½•å¯åŠ¨ | å¯åŠ¨è¯´æ˜.txt |
| æŠ€æœ¯ç»†èŠ‚ | README-PHP.md |
| æ¶æ„è¯´æ˜ | ARCHITECTURE.md |
| API è¶…æ—¶ | APIè¶…æ—¶é…ç½®è¯´æ˜.txt |

---

## âŒ¨ï¸ å¿«æ·é”®

| æ“ä½œ | å¿«æ·é”® |
|------|--------|
| åˆ é™¤é€‰ä¸­å›¾ç‰‡ | Delete/Backspace |
| æ’¤é”€ç”»ç¬” | ç‚¹å‡»ç•Œé¢ â†© |
| æ¸…ç©ºç”»å¸ƒ | ç‚¹å‡»ç•Œé¢ ğŸ—‘ |
| ç¼©æ”¾ç”»å¸ƒ | Ctrl + æ»šè½® |
| ç¼©æ”¾å›¾ç‰‡ | Shift + æ»šè½® |

---

## ğŸ¨ ä¸»é¢˜å®šåˆ¶

### ä¿®æ”¹é…è‰²
```css
/* ç¬¬ 103-114 è¡Œ */
:root {
    --accent: #4dabf7;  /* æ”¹ä¸ºä½ çš„å“ç‰Œè‰² */
}
```

### ä¿®æ”¹å­—ä½“
```css
/* ç¬¬ 111 è¡Œ */
--font-mono: 'Your Font', monospace;
```

---

## ğŸ“ ä»£ç ç‰‡æ®µ

### æ·»åŠ æ–°çš„ API ç«¯ç‚¹
```php
// åœ¨ç¬¬ 118 è¡Œä¹‹å‰æ·»åŠ 
elseif ($path[1] === 'myendpoint' && $_SERVER['REQUEST_METHOD'] === 'GET') {
    echo json_encode(['data' => 'value']);
    exit;
}
```

### æ·»åŠ æ–°çš„æ¨¡å¼
```javascript
// åœ¨ switchMode å‡½æ•°ä¸­æ·»åŠ 
if(mode === 'newmode') {
    initNewMode();
}
```

---

**å¿«é€Ÿå‚è€ƒç‰ˆæœ¬**: 1.0.0
**æœ€åæ›´æ–°**: 2025-12-26
